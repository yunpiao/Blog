---
title: 编程-code review 的检查清单
tags:
  - 编程经验
  - 总结
date: 2024-11-06T15:05:56+08:00
draft: false
toc: true
slug: "20241106150556"
categories:
  - 杂技浅尝
---
代码审核清单
## 1. 代码结构
超长代码、长函数、嵌套严重、入参多、死循环、 重复代码， error 处理
## 2. 代码注释
注释位置、 特殊逻辑注释、 缩进、 table 和 空格键、 函数头说明、入场说明、类文件开头说明
## 3. 安全性
io 资源是否关闭、double float 使用、 超大对象、 池大小、异常是否正常处理、日志记录、sql 预处理 防止注入、 命令可能造成死锁、并发下是否正常运行、入参是否检查、 异常处的敏感信息禁止外传造成信息泄露、 外部调用是否添加重试、密码等是否放置在代码区、 日志是否限制大小和天数
## 4. 性能
sql 执行时间、正则性能、 是否写了轮子、 对象是否复用（对象池）、异步IO、 锁粒度是否最小
## 5. 单元测试
是否可测试、重要功能模块必须有单测， 是否覆盖异常场景
## 6. 优化
枚举代替自定义、长遍历位置是否可以异步等、 for switch 、耗时函数是否可缓存、 lru 的使用、 io 是否可合并请求、 函数加缓存、
## 7. 运维
服务监控和基础监控（cpu 内存 磁盘 io等）、 重要指标是否 metrics 暴露（channel 长度， 处理时间、请求失败数量）、 sql 外发请求等远程执行时间是否限制或暴露可监控、metrics 指标是否设置告警、 告警等级 负责人 方式是否有清单可查、 自身监控是否有监控、 是否有页面可以查看整个系统服务状态、是否有探活, 迁移过程是否有损、出现问题有没有应急预案
## 8. 其他
逻辑 bug， 业务实现是否与需求有出入， 是否良好的可读性， 重点关注更改点对整体影响， 如更改工具函数是否兼容其他模块应用，每次审核代码不过多(做代码审查，每次审查的代码行数最好在 200 行以内，不超过 400 行，否则查找代码缺陷的效果就会大打折扣)， 异常演练，兼容性（不同内核、不同操作系统、不同网络状态）、 已知风险清单（可以造成故障）以及对应的应急处理方式、上线后的检查清单

